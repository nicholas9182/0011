ungroup() %>%
mutate(ang_group = abs(Angle)) %>%
group_by(Method, ang_group) %>%
mutate(Energy = min(Energy)) %>%
ungroup() %>%
select(-c(ang_group)) %>%
pivot_wider( names_from = Method , values_from = Energy ) %>%
mutate( Difference = B3LYP - MD_DOF_off ) %>%
pivot_longer(names_to = "Method" , values_to = "Energy", cols = c(B3LYP,MD_DOF_off,Difference)) %>%
ggplot(aes(x = Angle,  y = Energy, color = Method)) +
geom_point(size=2) +
geom_smooth(se=FALSE,span=0.1,size=1.5) +
labs(x = expression(phi~"[ "^o~"]"), y = "Energy [meV]")
rbind(a,b) %>%
rename(Angle = V1, Energy = V2) %>%
group_by(Method) %>%
mutate(
Energy = ifelse( Method=="B3LYP" , (Energy - min(Energy)) * (27211.3825435/10.36) , (Energy - min(Energy)) )
) %>%
ungroup() %>%
mutate(ang_group = abs(Angle)) %>%
group_by(Method, ang_group) %>%
mutate(Energy = min(Energy)) %>%
ungroup() %>%
select(-c(ang_group)) %>%
pivot_wider( names_from = Method , values_from = Energy ) %>%
mutate( Difference =  B3LYP - MD_DOF_off ) %>%
select(Angle, Difference) %>%
nest(data = c(Angle, Difference)) %>%
mutate(
fit = map( data , ~ nls( .x$Difference ~ RB(C0,C1,C2,C3,C4,C5,Angle),
start=list(C0=0,C1=0,C2=0,C3=0,C4=0,C5=0),
data= .x) ) ,
coefs = map( fit , tidy ) ,
predict = map(fit , predict) ) %>%
unnest(coefs) %>% print() %>%
nest(coefs = c(estimate, std.error, statistic, p.value)) %>%
unnest(predict, data) %>%
pivot_longer(values_to = "Energy" , names_to = "Method" , cols = c(Difference, predict)) %>%
ggplot(aes(x = Angle,  y = Energy, color = Method)) +
geom_point(size=2) +
geom_smooth(se=FALSE,span=0.1,size=1.5) +
labs(x = expression(phi~"[ "^o~"]"), y = "Energy [kJ/mol]")
c <- read.table("/Users/nicholassiemons/Dropbox/OBT/0011/Parameter_Optimisations/pBTTT_thiophene_thienothiophene/MD_scan_on.txt") %>% mutate(Method = "MD_DOF_on")
rbind(a,b,c) %>%
rename(Angle = V1, Energy = V2) %>%
group_by(Method) %>%
mutate(
Energy = ifelse( Method=="B3LYP" , (Energy - min(Energy)) * 27211.3825435 , (Energy - min(Energy))*10.36 )
) %>%
ungroup() %>%
mutate(ang_group = abs(Angle)) %>%
group_by(Method, ang_group) %>%
mutate(Energy = min(Energy)) %>%
ungroup() %>%
select(-c(ang_group)) %>%
ggplot(aes(x = Angle,  y = Energy, color = Method)) +
geom_point(size=2) +
geom_smooth(se=FALSE,span=0.1,size=1.5) +
labs(x = expression(phi~"[ "^o~"]"), y = "Energy [meV]", color="")
ggsave("Figures/pBTTT_thiophene_thienothiophene_Dihedral.pdf",width=12)
rbind(a,c) %>%
rename(Angle = V1, Energy = V2) %>%
group_by(Method) %>%
mutate(
Energy = ifelse( Method=="B3LYP" , (Energy - min(Energy)) * 27211.3825435 , (Energy - min(Energy))*10.36 )
) %>%
ungroup() %>%
mutate(ang_group = abs(Angle)) %>%
group_by(Method, ang_group) %>%
mutate(Energy = min(Energy)) %>%
ungroup() %>%
select(-c(ang_group)) %>%
nest(data = c(Angle, Energy)) %>%
mutate(Pop = map(data , ~ boltz_invert(x = .$Angle , y = .$Energy)) ) %>%
unnest(Pop, data) %>%
ggplot(aes(x = Angle,  y = Pop, color = Method)) +
geom_point(size=2) +
geom_smooth(se=FALSE,span=0.1,size=1.5) +
labs(x = expression(phi~"[ "^o~"]"), y = "Relative Populations")
a <- read.table("~/Dropbox/OBT/0011/Parameter_Optimisations/pgT2_TT_thiophene_thienothiophene/QCC_files/pg2T_TT.txt") %>% mutate(Method="B3LYP")
b <- read.table("/Users/nicholassiemons/Dropbox/OBT/0011/Parameter_Optimisations/pgT2_TT_thiophene_thienothiophene/MD_scan_off.txt") %>% mutate(Method = "MD_DOF_off")
rbind(a,b) %>%
rename(Angle = V1, Energy = V2) %>%
group_by(Method) %>%
mutate(
Energy = ifelse( Method=="B3LYP" , (Energy - min(Energy)) * 27211.3825435 , (Energy - min(Energy))*10.36 )
) %>%
ungroup() %>%
mutate(ang_group = abs(Angle)) %>%
group_by(Method, ang_group) %>%
mutate(Energy = min(Energy)) %>%
ungroup() %>%
select(-c(ang_group)) %>%
pivot_wider( names_from = Method , values_from = Energy ) %>%
mutate( Difference = B3LYP - MD_DOF_off ) %>%
pivot_longer(names_to = "Method" , values_to = "Energy", cols = c(B3LYP,MD_DOF_off,Difference)) %>%
ggplot(aes(x = Angle,  y = Energy, color = Method)) +
geom_point(size=2) +
geom_smooth(se=FALSE,span=0.1,size=1.5) +
labs(x = expression(phi~"[ "^o~"]"), y = "Energy [meV]")
rbind(a,b) %>%
rename(Angle = V1, Energy = V2) %>%
group_by(Method) %>%
mutate(
Energy = ifelse( Method=="B3LYP" , (Energy - min(Energy)) * (27211.3825435/10.36) , (Energy - min(Energy)) )
) %>%
ungroup() %>%
mutate(ang_group = abs(Angle)) %>%
group_by(Method, ang_group) %>%
mutate(Energy = min(Energy)) %>%
ungroup() %>%
select(-c(ang_group)) %>%
pivot_wider( names_from = Method , values_from = Energy ) %>%
mutate( Difference =  B3LYP - MD_DOF_off ) %>%
select(Angle, Difference) %>%
nest(data = c(Angle, Difference)) %>%
mutate(
fit = map( data , ~ nls( .x$Difference ~ RB(C0,C1,C2,C3,C4,C5,Angle),
start=list(C0=0,C1=0,C2=0,C3=0,C4=0,C5=0),
weights = boltz_invert_kjmol(x = a$V1, y = a$V2) ,
data= .x) ) ,
coefs = map( fit , tidy ) ,
predict = map(fit , predict) ) %>%
unnest(coefs) %>% print() %>%
nest(coefs = c(estimate, std.error, statistic, p.value)) %>%
unnest(predict, data) %>%
pivot_longer(values_to = "Energy" , names_to = "Method" , cols = c(Difference, predict)) %>%
ggplot(aes(x = Angle,  y = Energy, color = Method)) +
geom_point(size=2) +
geom_smooth(se=FALSE,span=0.1,size=1.5) +
labs(x = expression(phi~"[ "^o~"]"), y = "Energy [kJ/mol]")
rbind(a,b) %>%
rename(Angle = V1, Energy = V2) %>%
group_by(Method) %>%
mutate(
Energy = ifelse( Method=="B3LYP" , (Energy - min(Energy)) * (27211.3825435/10.36) , (Energy - min(Energy)) )
) %>%
ungroup() %>%
mutate(ang_group = abs(Angle)) %>%
group_by(Method, ang_group) %>%
mutate(Energy = min(Energy)) %>%
ungroup() %>%
select(-c(ang_group)) %>%
pivot_wider( names_from = Method , values_from = Energy ) %>%
mutate( Difference =  B3LYP - MD_DOF_off ) %>%
select(Angle, Difference) %>%
nest(data = c(Angle, Difference)) %>%
mutate(
fit = map( data , ~ nls( .x$Difference ~ RB(C0,C1,C2,C3,C4,C5,Angle),
start=list(C0=0,C1=0,C2=0,C3=0,C4=0,C5=0),
data= .x) ) ,
coefs = map( fit , tidy ) ,
predict = map(fit , predict) ) %>%
unnest(coefs) %>% print() %>%
nest(coefs = c(estimate, std.error, statistic, p.value)) %>%
unnest(predict, data) %>%
pivot_longer(values_to = "Energy" , names_to = "Method" , cols = c(Difference, predict)) %>%
ggplot(aes(x = Angle,  y = Energy, color = Method)) +
geom_point(size=2) +
geom_smooth(se=FALSE,span=0.1,size=1.5) +
labs(x = expression(phi~"[ "^o~"]"), y = "Energy [kJ/mol]")
rbind(a,b) %>%
rename(Angle = V1, Energy = V2) %>%
group_by(Method) %>%
mutate(
Energy = ifelse( Method=="B3LYP" , (Energy - min(Energy)) * (27211.3825435/10.36) , (Energy - min(Energy)) )
) %>%
ungroup() %>%
mutate(ang_group = abs(Angle)) %>%
group_by(Method, ang_group) %>%
mutate(Energy = min(Energy)) %>%
ungroup() %>%
select(-c(ang_group)) %>%
pivot_wider( names_from = Method , values_from = Energy ) %>%
mutate( Difference =  B3LYP - MD_DOF_off ) %>%
select(Angle, Difference) %>%
nest(data = c(Angle, Difference))
rbind(a,b) %>%
rename(Angle = V1, Energy = V2) %>%
group_by(Method) %>%
mutate(
Energy = ifelse( Method=="B3LYP" , (Energy - min(Energy)) * (27211.3825435/10.36) , (Energy - min(Energy)) )
) %>%
ungroup() %>%
mutate(ang_group = abs(Angle)) %>%
group_by(Method, ang_group) %>%
mutate(Energy = min(Energy)) %>%
ungroup() %>%
select(-c(ang_group)) %>%
pivot_wider( names_from = Method , values_from = Energy ) %>%
mutate( Difference =  B3LYP - MD_DOF_off ) %>%
select(Angle, Difference)
rbind(a,b) %>%
rename(Angle = V1, Energy = V2)
rbind(a,b) %>%
rename(Angle = V1, Energy = V2) %>%
pivot_wider(names_from = Method , values_from = Energy)
rbind(a,b) %>%
rename(Angle = V1, Energy = V2) %>%
group_by(Method) %>%
mutate(
Energy = ifelse( Method=="B3LYP" , (Energy - min(Energy)) * 27211.3825435 , (Energy - min(Energy))*10.36 )
) %>%
ungroup() %>%
mutate(ang_group = abs(Angle)) %>%
group_by(Method, ang_group) %>%
mutate(Energy = min(Energy)) %>%
ungroup() %>%
select(-c(ang_group)) %>%
pivot_wider( names_from = Method , values_from = Energy ) %>%
drop_na() %>%
mutate( Difference = B3LYP - MD_DOF_off ) %>%
pivot_longer(names_to = "Method" , values_to = "Energy", cols = c(B3LYP,MD_DOF_off,Difference)) %>%
ggplot(aes(x = Angle,  y = Energy, color = Method)) +
geom_point(size=2) +
geom_smooth(se=FALSE,span=0.1,size=1.5) +
labs(x = expression(phi~"[ "^o~"]"), y = "Energy [meV]")
rbind(a,b) %>%
rename(Angle = V1, Energy = V2) %>%
pivot_wider(names_from = Method , values_from = Energy) %>%
drop_na() %>%
pivot_longer(names_to = "Method" , values_to = "Energy", cols = c(B3LYP,MD_DOF_off))
rbind(a,b) %>%
rename(Angle = V1, Energy = V2) %>%
pivot_wider(names_from = Method , values_from = Energy) %>%
drop_na() %>%
pivot_longer(names_to = "Method" , values_to = "Energy", cols = c(B3LYP,MD_DOF_off))
rbind(a,b) %>%
rename(Angle = V1, Energy = V2) %>%
pivot_wider(names_from = Method , values_from = Energy) %>%
drop_na() %>%
pivot_longer(names_to = "Method" , values_to = "Energy", cols = c(B3LYP,MD_DOF_off)) %>%
group_by(Method) %>%
mutate(
Energy = ifelse( Method=="B3LYP" , (Energy - min(Energy)) * (27211.3825435/10.36) , (Energy - min(Energy)) )
) %>%
ungroup() %>%
mutate(ang_group = abs(Angle)) %>%
group_by(Method, ang_group) %>%
mutate(Energy = min(Energy)) %>%
ungroup() %>%
select(-c(ang_group)) %>%
pivot_wider( names_from = Method , values_from = Energy ) %>%
mutate( Difference =  B3LYP - MD_DOF_off ) %>%
select(Angle, Difference) %>%
nest(data = c(Angle, Difference)) %>%
mutate(
fit = map( data , ~ nls( .x$Difference ~ RB(C0,C1,C2,C3,C4,C5,Angle),
start=list(C0=0,C1=0,C2=0,C3=0,C4=0,C5=0),
data= .x) ) ,
coefs = map( fit , tidy ) ,
predict = map(fit , predict) ) %>%
unnest(coefs) %>% print() %>%
nest(coefs = c(estimate, std.error, statistic, p.value)) %>%
unnest(predict, data) %>%
pivot_longer(values_to = "Energy" , names_to = "Method" , cols = c(Difference, predict)) %>%
ggplot(aes(x = Angle,  y = Energy, color = Method)) +
geom_point(size=2) +
geom_smooth(se=FALSE,span=0.1,size=1.5) +
labs(x = expression(phi~"[ "^o~"]"), y = "Energy [kJ/mol]")
RB <- function(C0,C1,C2,C3,C4,C5,Angle){
V <-    C0*cos(Angle*0.0174533)^0 +
-C1*cos(Angle*0.0174533)^1 +
C2*cos(Angle*0.0174533)^2 +
-C3*cos(Angle*0.0174533)^3 +
C4*cos(Angle*0.0174533)^4 +
-C5*cos(Angle*0.0174533)^5
return(V)
}
a <- read.table("~/Dropbox/OBT/0011/Parameter_Optimisations/pgT2_TT_thiophene_thienothiophene/QCC_files/pg2T_TT.txt") %>% mutate(Method="B3LYP")
b <- read.table("/Users/nicholassiemons/Dropbox/OBT/0011/Parameter_Optimisations/pgT2_TT_thiophene_thienothiophene/MD_scan_off.txt") %>% mutate(Method = "MD_DOF_off")
rbind(a,b) %>%
rename(Angle = V1, Energy = V2) %>%
group_by(Method) %>%
mutate(
Energy = ifelse( Method=="B3LYP" , (Energy - min(Energy)) * 27211.3825435 , (Energy - min(Energy))*10.36 )
) %>%
ungroup() %>%
mutate(ang_group = abs(Angle)) %>%
group_by(Method, ang_group) %>%
mutate(Energy = min(Energy)) %>%
ungroup() %>%
select(-c(ang_group)) %>%
pivot_wider( names_from = Method , values_from = Energy ) %>%
drop_na() %>%
mutate( Difference = B3LYP - MD_DOF_off ) %>%
pivot_longer(names_to = "Method" , values_to = "Energy", cols = c(B3LYP,MD_DOF_off,Difference)) %>%
ggplot(aes(x = Angle,  y = Energy, color = Method)) +
geom_point(size=2) +
geom_smooth(se=FALSE,span=0.1,size=1.5) +
labs(x = expression(phi~"[ "^o~"]"), y = "Energy [meV]")
rbind(a,b) %>%
rename(Angle = V1, Energy = V2) %>%
pivot_wider(names_from = Method , values_from = Energy) %>%
drop_na() %>%
pivot_longer(names_to = "Method" , values_to = "Energy", cols = c(B3LYP,MD_DOF_off)) %>%
group_by(Method) %>%
mutate(
Energy = ifelse( Method=="B3LYP" , (Energy - min(Energy)) * (27211.3825435/10.36) , (Energy - min(Energy)) )
) %>%
ungroup() %>%
mutate(ang_group = abs(Angle)) %>%
group_by(Method, ang_group) %>%
mutate(Energy = min(Energy)) %>%
ungroup() %>%
select(-c(ang_group)) %>%
pivot_wider( names_from = Method , values_from = Energy ) %>%
mutate( Difference =  B3LYP - MD_DOF_off ) %>%
select(Angle, Difference) %>%
nest(data = c(Angle, Difference)) %>%
mutate(
fit = map( data , ~ nls( .x$Difference ~ RB(C0,C1,C2,C3,C4,C5,Angle),
start=list(C0=0,C1=0,C2=0,C3=0,C4=0,C5=0),
data= .x) ) ,
coefs = map( fit , tidy ) ,
predict = map(fit , predict) ) %>%
unnest(coefs) %>% print() %>%
nest(coefs = c(estimate, std.error, statistic, p.value)) %>%
unnest(predict, data) %>%
pivot_longer(values_to = "Energy" , names_to = "Method" , cols = c(Difference, predict)) %>%
ggplot(aes(x = Angle,  y = Energy, color = Method)) +
geom_point(size=2) +
geom_smooth(se=FALSE,span=0.1,size=1.5) +
labs(x = expression(phi~"[ "^o~"]"), y = "Energy [kJ/mol]")
c <- read.table("/Users/nicholassiemons/Dropbox/OBT/0011/Parameter_Optimisations/gpBTTT_thiophene_thienothiophene/MD_scan_on.txt") %>% mutate(Method = "MD_DOF_on")
rbind(a,b,c) %>%
rename(Angle = V1, Energy = V2) %>%
group_by(Method) %>%
mutate(
Energy = ifelse( Method=="B3LYP" , (Energy - min(Energy)) * 27211.3825435 , (Energy - min(Energy))*10.36 )
) %>%
ungroup() %>%
mutate(ang_group = abs(Angle)) %>%
group_by(Method, ang_group) %>%
mutate(Energy = min(Energy)) %>%
ungroup() %>%
select(-c(ang_group)) %>%
ggplot(aes(x = Angle,  y = Energy, color = Method)) +
geom_point(size=2) +
geom_smooth(se=FALSE,span=0.1,size=1.5) +
labs(x = expression(phi~"[ "^o~"]"), y = "Energy [meV]", color="")
ggsave("Figures/gT2_TT_thiophene_thienothiophene_Dihedral.pdf",width=12)
rbind(a,c) %>%
rename(Angle = V1, Energy = V2) %>%
group_by(Method) %>%
mutate(
Energy = ifelse( Method=="B3LYP" , (Energy - min(Energy)) * 27211.3825435 , (Energy - min(Energy))*10.36 )
) %>%
ungroup() %>%
mutate(ang_group = abs(Angle)) %>%
group_by(Method, ang_group) %>%
mutate(Energy = min(Energy)) %>%
ungroup() %>%
select(-c(ang_group)) %>%
nest(data = c(Angle, Energy)) %>%
mutate(Pop = map(data , ~ boltz_invert(x = .$Angle , y = .$Energy)) ) %>%
unnest(Pop, data) %>%
ggplot(aes(x = Angle,  y = Pop, color = Method)) +
geom_point(size=2) +
geom_smooth(se=FALSE,span=0.1,size=1.5) +
labs(x = expression(phi~"[ "^o~"]"), y = "Relative Populations")
rbind(a,b,c) %>%
rename(Angle = V1, Energy = V2) %>%
group_by(Method) %>%
mutate(
Energy = ifelse( Method=="B3LYP" , (Energy - min(Energy)) * 27211.3825435 , (Energy - min(Energy))*10.36 )
) %>%
ungroup() %>%
mutate(ang_group = (Angle)) %>%
group_by(Method, ang_group) %>%
mutate(Energy = min(Energy)) %>%
ungroup() %>%
select(-c(ang_group)) %>%
ggplot(aes(x = Angle,  y = Energy, color = Method)) +
geom_point(size=2) +
geom_smooth(se=FALSE,span=0.1,size=1.5) +
labs(x = expression(phi~"[ "^o~"]"), y = "Energy [meV]", color="")
rbind(a,b,c) %>%
rename(Angle = V1, Energy = V2) %>%
group_by(Method) %>%
mutate(
Energy = ifelse( Method=="B3LYP" , (Energy - min(Energy)) * 27211.3825435 , (Energy - min(Energy))*10.36 )
) %>%
ungroup() %>%
mutate(ang_group = abs(Angle)) %>%
group_by(Method, ang_group) %>%
mutate(Energy = min(Energy)) %>%
ungroup() %>%
select(-c(ang_group)) %>%
ggplot(aes(x = Angle,  y = Energy, color = Method)) +
geom_point(size=2) +
geom_smooth(se=FALSE,span=0.1,size=1.5) +
labs(x = expression(phi~"[ "^o~"]"), y = "Energy [meV]", color="")
c <- read.table("/Users/nicholassiemons/Dropbox/OBT/0011/Parameter_Optimisations/pgT2_TT_thiophene_thienothiophene/MD_scan_on.txt") %>% mutate(Method = "MD_DOF_on")
rbind(a,b,c) %>%
rename(Angle = V1, Energy = V2) %>%
group_by(Method) %>%
mutate(
Energy = ifelse( Method=="B3LYP" , (Energy - min(Energy)) * 27211.3825435 , (Energy - min(Energy))*10.36 )
) %>%
ungroup() %>%
mutate(ang_group = abs(Angle)) %>%
group_by(Method, ang_group) %>%
mutate(Energy = min(Energy)) %>%
ungroup() %>%
select(-c(ang_group)) %>%
ggplot(aes(x = Angle,  y = Energy, color = Method)) +
geom_point(size=2) +
geom_smooth(se=FALSE,span=0.1,size=1.5) +
labs(x = expression(phi~"[ "^o~"]"), y = "Energy [meV]", color="")
RB <- function(C0,C1,C2,C3,C4,C5,Angle){
V <-    C0*cos(Angle*0.0174533)^0 +
-C1*cos(Angle*0.0174533)^1 +
C2*cos(Angle*0.0174533)^2 +
-C3*cos(Angle*0.0174533)^3 +
C4*cos(Angle*0.0174533)^4 +
-C5*cos(Angle*0.0174533)^5
return(V)
}
a <- read.table("~/Dropbox/OBT/0011/Parameter_Optimisations/pgT2_TT_thiophene_thienothiophene/QCC_files/pg2T_TT.txt") %>% mutate(Method="B3LYP")
b <- read.table("/Users/nicholassiemons/Dropbox/OBT/0011/Parameter_Optimisations/pgT2_TT_thiophene_thienothiophene/MD_scan_off.txt") %>% mutate(Method = "MD_DOF_off")
rbind(a,b) %>%
rename(Angle = V1, Energy = V2) %>%
group_by(Method) %>%
mutate(
Energy = ifelse( Method=="B3LYP" , (Energy - min(Energy)) * 27211.3825435 , (Energy - min(Energy))*10.36 )
) %>%
ungroup() %>%
mutate(ang_group = abs(Angle)) %>%
group_by(Method, ang_group) %>%
mutate(Energy = min(Energy)) %>%
ungroup() %>%
select(-c(ang_group)) %>%
pivot_wider( names_from = Method , values_from = Energy ) %>%
drop_na() %>%
mutate( Difference = B3LYP - MD_DOF_off ) %>%
pivot_longer(names_to = "Method" , values_to = "Energy", cols = c(B3LYP,MD_DOF_off,Difference)) %>%
ggplot(aes(x = Angle,  y = Energy, color = Method)) +
geom_point(size=2) +
geom_smooth(se=FALSE,span=0.1,size=1.5) +
labs(x = expression(phi~"[ "^o~"]"), y = "Energy [meV]")
rbind(a,b) %>%
rename(Angle = V1, Energy = V2) %>%
pivot_wider(names_from = Method , values_from = Energy) %>%
drop_na() %>%
pivot_longer(names_to = "Method" , values_to = "Energy", cols = c(B3LYP,MD_DOF_off)) %>%
group_by(Method) %>%
mutate(
Energy = ifelse( Method=="B3LYP" , (Energy - min(Energy)) * (27211.3825435/10.36) , (Energy - min(Energy)) )
) %>%
ungroup() %>%
mutate(ang_group = abs(Angle)) %>%
group_by(Method, ang_group) %>%
mutate(Energy = min(Energy)) %>%
ungroup() %>%
select(-c(ang_group)) %>%
pivot_wider( names_from = Method , values_from = Energy ) %>%
mutate( Difference =  B3LYP - MD_DOF_off ) %>%
select(Angle, Difference) %>%
nest(data = c(Angle, Difference)) %>%
mutate(
fit = map( data , ~ nls( .x$Difference ~ RB(C0,C1,C2,C3,C4,C5,Angle),
start=list(C0=0,C1=0,C2=0,C3=0,C4=0,C5=0),
data= .x) ) ,
coefs = map( fit , tidy ) ,
predict = map(fit , predict) ) %>%
unnest(coefs) %>% print() %>%
nest(coefs = c(estimate, std.error, statistic, p.value)) %>%
unnest(predict, data) %>%
pivot_longer(values_to = "Energy" , names_to = "Method" , cols = c(Difference, predict)) %>%
ggplot(aes(x = Angle,  y = Energy, color = Method)) +
geom_point(size=2) +
geom_smooth(se=FALSE,span=0.1,size=1.5) +
labs(x = expression(phi~"[ "^o~"]"), y = "Energy [kJ/mol]")
c <- read.table("/Users/nicholassiemons/Dropbox/OBT/0011/Parameter_Optimisations/pgT2_TT_thiophene_thienothiophene/MD_scan_on.txt") %>% mutate(Method = "MD_DOF_on")
rbind(a,b,c) %>%
rename(Angle = V1, Energy = V2) %>%
group_by(Method) %>%
mutate(
Energy = ifelse( Method=="B3LYP" , (Energy - min(Energy)) * 27211.3825435 , (Energy - min(Energy))*10.36 )
) %>%
ungroup() %>%
mutate(ang_group = abs(Angle)) %>%
group_by(Method, ang_group) %>%
mutate(Energy = min(Energy)) %>%
ungroup() %>%
select(-c(ang_group)) %>%
ggplot(aes(x = Angle,  y = Energy, color = Method)) +
geom_point(size=2) +
geom_smooth(se=FALSE,span=0.1,size=1.5) +
labs(x = expression(phi~"[ "^o~"]"), y = "Energy [meV]", color="")
ggsave("Figures/gT2_TT_thiophene_thienothiophene_Dihedral.pdf",width=12)
rbind(a,c) %>%
rename(Angle = V1, Energy = V2) %>%
group_by(Method) %>%
mutate(
Energy = ifelse( Method=="B3LYP" , (Energy - min(Energy)) * 27211.3825435 , (Energy - min(Energy))*10.36 )
) %>%
ungroup() %>%
mutate(ang_group = abs(Angle)) %>%
group_by(Method, ang_group) %>%
mutate(Energy = min(Energy)) %>%
ungroup() %>%
select(-c(ang_group)) %>%
nest(data = c(Angle, Energy)) %>%
mutate(Pop = map(data , ~ boltz_invert(x = .$Angle , y = .$Energy)) ) %>%
unnest(Pop, data) %>%
ggplot(aes(x = Angle,  y = Pop, color = Method)) +
geom_point(size=2) +
geom_smooth(se=FALSE,span=0.1,size=1.5) +
labs(x = expression(phi~"[ "^o~"]"), y = "Relative Populations")
